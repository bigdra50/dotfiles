---
paths: "**/*.cs"
---

# C#

## 原則

### 関数型アプローチ
- 純粋関数を優先
- 不変データ構造（recordを活用）
- 副作用を分離
- null安全（Nullable Reference Types有効化）

### ドメイン駆動設計
- 値オブジェクトとエンティティを区別
- 集約で整合性を保証
- ドメインサービスは最終手段

### テスト駆動開発
- Red-Green-Refactorサイクル
- テストを仕様として扱う
- アサートファースト

## 型設計

- `record`で不変な値オブジェクト
- `readonly struct`でパフォーマンス重視の値型
- `sealed`をデフォルトに
- パターンマッチングを活用

## コードスタイル

- 早期リターンで条件分岐をフラット化
- `var`は型が明確な場合のみ
- LINQ優先（命令型ループより）
- 式本体メンバーを適切に使用

## Unity固有

- MonoBehaviourは薄く保つ
- ScriptableObjectで設定を外部化
- Zenject/VContainerでDI
- UniTask/UniRxで非同期処理

## 実装手順

1. 型設計 - まずinterfaceとrecordを定義
2. 純粋関数から実装 - テストを先に書く
3. 副作用を分離
4. アダプター実装 - 外部依存を抽象化

## エラーハンドリング

- Result型パターンを検討
- 例外は回復不能なエラーのみ
- カスタム例外で型安全に
