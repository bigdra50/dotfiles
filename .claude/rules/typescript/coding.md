---
paths: "**/*.ts, **/*.tsx, **/*.js, **/*.jsx"
---

# TypeScript / JavaScript

## 原則

### 関数型アプローチ
- 純粋関数を優先
- 不変データ構造（Immutable.js, immer, または spread operator）
- 副作用を分離（IO操作は境界に押し出す）
- 型安全性を確保（any禁止、unknown推奨）

### ドメイン駆動設計
- 値オブジェクトとエンティティを区別
- 集約で整合性を保証
- ドメインサービスは最終手段

### テスト駆動開発
- Red-Green-Refactorサイクル
- テストを仕様として扱う
- アサートファースト

## 型設計

- `type`を優先、`interface`は拡張が必要な場合のみ
- Union型で状態を表現
- Branded Typeで意味のある型を作成
- `as`キャストは最小限

## コードスタイル

- 早期リターンで条件分岐をフラット化
- Optional Chainingを活用（`?.`, `??`）
- const assertionで型推論を強化
- 配列操作は`map`, `filter`, `reduce`を優先

## 実装手順

1. 型設計 - まず型を定義
2. 純粋関数から実装 - テストを先に書く
3. 副作用を分離
4. アダプター実装 - 外部依存を抽象化

## エラーハンドリング

- Result型パターンを検討（neverthrow等）
- 例外は回復不能なエラーのみ
- カスタムエラークラスで型安全に
